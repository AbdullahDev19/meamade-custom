# Auth Providers

In this document, you’ll learn how the Auth Module handles authentication using providers.

## What is an Auth Provider?

An auth provider is a TypeScript or JavaScript class used to authenticate customers and users. Each provider implements the authentication logic based on its purpose.

For example, the `emailpass` provider authenticates a user using their email and password, whereas the `google` provider authenticates users using their Google account.

---

## The Auth Provider Class

An auth provider implements the `AbstractAuthModuleProvider` class imported from the `@medusajs/utils` package. The provider must implement the `authenticate` method that authenticates a user.

When you call the `authenticate` method of the Auth Module's main service (`IAuthModuleService`), the method resolves the specified provider and calls its `authenticate` method passing it the second parameter it received:

```ts
const data = await authModuleService.authenticate(
    "emailpass",
    // passed to auth provider
    {
      // ...
    }
  )
```

It also returns the same data returned by the auth provider.

<Note>

Learn about the parameters and return type of the `IAuthModuleService`'s `authenticate` method in [this reference](../../../references/auth/IAuthModuleService/methods/auth.IAuthModuleService.authenticate.mdx).

</Note>

---

## Basic Authentication

If the `authenticate` method returns the following object:

```ts
{
	success: true,
	authUser: { ... }
}
```

Then, the user is authenticated successfully, and their authentication details are available within the `authUser` object.

<Note>

Learn more about the `authUser` in [this guide](../persisting-auth-user/index.mdx#what-is-an-authuser).

</Note>

![Diagram showcasing the basic authentication flow](https://res.cloudinary.com/dza7lstvk/image/upload/v1711373749/Medusa%20Resources/basic-auth_lgpqsj.jpg)

---

## Authentication with Third-Party Service

If the `authenticate` method returns the following object:

```ts
{
	success: true,
	location: "https://...."
}
```

It means the authentication process requires the user to perform an action with a third-party service. For example, when using the `google` provider, the user goes to the URL specified in the `location`'s value to log in with their Google account. 

![Diagram showcasing the first part of the third-party authentication flow](https://res.cloudinary.com/dza7lstvk/image/upload/v1711374847/Medusa%20Resources/third-party-auth-1_enyedy.jpg)

### validateCallback

Providers handling this authentication flow must implement the `validateCallback` method. It implements the logic to validate the authentication with the third-party service.

So, once the user performs the required action, the third-party service must redirect to an API route that uses the `validateCallback` method of the `IAuthModuleService`. The method calls the specified provider’s `validateCallback` method passing it the authentication details it received in the second parameter:

```ts
const data = await authModuleService.validateCallback(
    "google",
    // passed to auth provider
    {
      // ...
    }
  )
```

<Note>

Learn more about the parameters and return type of the `IAuthModuleService`'s `validateCallback` method in [this reference](../../../references/auth/IAuthModuleService/methods/auth.IAuthModuleService.validateCallback.mdx).

</Note>

If the authentication is successful, the auth provider’s `validateCallback` method returns the same data as the basic authentication:

```ts
{
	success: true,
	authUser: { ... }
}
```

![Diagram showcasing the second part of the third-party authentication flow](https://res.cloudinary.com/dza7lstvk/image/upload/v1711375123/Medusa%20Resources/third-party-auth-2_kmjxju.jpg)